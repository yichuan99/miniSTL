This is a simplified version of C++ STL implementation. 